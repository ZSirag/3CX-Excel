var vCardParser=function(){var r={TITLE:"title",TEL:"telephone",FN:"displayName",N:"name",EMAIL:"email",CATEGORIES:"categories",ADR:"address",URL:"url",NOTE:"notes",ORG:"organization",BDAY:"birthday",PHOTO:"photo"};function n(n,e){var t=r[e];return t||"BEGIN"===e||"END"===e||(n.info("define property name for "+e),t=e),t}function e(r){return"item"===r.substring(0,4)?r.match(/item\d\.(.*)/)[1]:r}function t(r,n,e){n=n.replace("\\n","\n"),r.currentCard[e]?r.currentCard[e]+="\n"+n:r.currentCard[e]=n}function a(r,n,e,t,a){var i=!1;t=(t=t.filter((function(r){return i=i||"PREF"===r.name,"PREF"!==r.name}))).reduce((function(r,n){return r[n.name]=n.value,r}),{}),r.currentCard[e]=r.currentCard[e]||[],r.currentCard[e].push({isDefault:i,valueInfo:t,value:a?a(n):n})}function i(r,n,e){r.currentCard[e]=n.split(",")}function u(){}var o,c={BEGIN:u,VERSION:u,N:(o=["surname","name","additionalName","prefix","suffix"],function(r,n,e){var t=n.split(";");r.currentCard[e]=o.reduce((function(r,n,e){return r[n]=t[e]||"",r}),{})}),TITLE:t,TEL:a,EMAIL:a,ADR:function(r,n,e,t){a(r,n,e,t,(function(r){var n=r.split(";");return{postOfficeBox:n[0],number:n[1],street:n[2]||"",city:n[3]||"",region:n[4]||"",postalCode:n[5]||"",country:n[6]||""}}))},NOTE:t,NICKNAME:i,BDAY:function(r,n,e){var t;(t=8===(n=16===n.length?n.substr(0,8):n).length?new Date(n.substr(0,4),n.substr(4,2),n.substr(6,2)):new Date(n))&&!isNaN(t.getDate())||(t=null,r.error("invalid date format "+n)),r.currentCard[e]=t&&t.toJSON()},URL:t,CATEGORIES:i,END:function(r){r.cards.push(r.currentCard),r.currentCard={}},FN:t,ORG:t,UID:t,PHOTO:t};return{parse:function(r){var t={info:function(r){console.info(r)},error:function(r){console.error(r)},data:r.replace(/\n\s{1}/g,"").split(/\r\n(?=\S)|\r(?=\S)|\n(?=\S)/),currentCard:{},cards:[]};return function(r){for(var t=0;t<r.data.length;t++){var a,i=e(r.data[t]),u=i.split(":"),o=u[0],s=u.slice(1).join(":");if(o.indexOf(";")>=0&&i.indexOf(";")<i.indexOf(":")){var f=o.split(";");o=f[0],a=f.slice(1).map((function(r){var n,e,t=r.split("=");return{name:null===(n=t[0])||void 0===n?void 0:n.toLowerCase(),value:null===(e=t[1])||void 0===e?void 0:e.replace(/"(.*)"/,"$1")}}))}o=o.toUpperCase();var d=c[o];d?d(r,s,n(r,o),a):"X-"!=o.substring(0,2)&&r.info("unknown field "+o+" with value "+s)}}(t),t.cards}}}();